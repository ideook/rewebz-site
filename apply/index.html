<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rewebz | Apply</title>
    <style>
      body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; margin: 0; background:#0b1020; color:#eaf0ff; }
      .wrap { max-width: 760px; margin: 40px auto; padding: 24px; }
      h1 { margin: 0 0 8px; }
      p { color:#9fb0d4; }
      form { display:grid; gap:12px; margin-top:24px; }
      label { font-size: 13px; color:#9fb0d4; }
      input,select,textarea,button { width:100%; padding:12px; border-radius:10px; border:1px solid #22315f; background:#111933; color:#eaf0ff; }
      textarea { min-height: 110px; }
      button { background:#56e39f; color:#071112; font-weight:700; cursor:pointer; border:none; }
      .msg { margin-top: 10px; font-size:14px; }
      .ok { color:#56e39f; }
      .err { color:#ff7b7b; }
    </style>
  </head>
  <body>
    <main class="wrap">
      <h1>서비스 신청</h1>
      <p>기존 사이트를 분석해 개선 목업을 빠르게 만들어드립니다.</p>

      <form id="applyForm">
        <div>
          <label>업체명 *</label>
          <input name="business_name" required />
        </div>
        <div>
          <label>기존 홈페이지 URL</label>
          <input name="website_url" placeholder="https://..." />
        </div>
        <div>
          <label>담당자명 *</label>
          <input name="contact_name" required />
        </div>
        <div>
          <label>이메일 *</label>
          <input type="email" name="contact_email" required />
        </div>
        <div>
          <label>연락처</label>
          <input name="contact_phone" />
        </div>
        <div>
          <label>업종</label>
          <select name="category">
            <option value="">선택</option>
            <option>서비스업</option>
            <option>엔지니어링/제조</option>
            <option>판매업</option>
            <option>기타</option>
          </select>
        </div>
        <div>
          <label>지역</label>
          <input name="region" />
        </div>
        <div>
          <label>목표</label>
          <textarea name="goal" placeholder="예: 문의 전환율 개선, 신뢰감 강화"></textarea>
        </div>
        <div>
          <label>추가 메모</label>
          <textarea name="notes"></textarea>
        </div>
        <button type="submit">신청하기</button>
      </form>

      <div id="msg" class="msg"></div>
    </main>

    <script>
      const form = document.getElementById('applyForm');
      const msg = document.getElementById('msg');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        msg.textContent = '저장 중...';
        msg.className = 'msg';

        const payload = Object.fromEntries(new FormData(form).entries());

        try {
          const res = await fetch('/api/apply', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
          });

          const data = await res.json();
          if (!res.ok) throw new Error(data?.error || '저장 실패');

          msg.textContent = `접수 완료! 요청번호: ${data.requestId}`;
          msg.className = 'msg ok';
          form.reset();
        } catch (err) {
          msg.textContent = `오류: ${err.message}`;
          msg.className = 'msg err';
        }
      });
    </script>
  </body>
</html>
